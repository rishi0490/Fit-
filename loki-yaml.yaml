backend:
  persistence:
    enabled: true
    storageClass: managed
    size: 20Gi
read:
  persistence:
    enabled: true
    storageClass: managed
    size: 20Gi
write:
  persistence:
    enabled: true
    storageClass: managed
    size: 20Gi
compactor:
  persistence:
    enabled: true
    storageClass: managed
    size: 20Gi

ruler:
  enabled: true
  persistence:
    enabled: true
    storageClass: managed
    size: 5Gi


loki:
  auth_enabled: false

  server:
    log_level: warn
    http_server_read_timeout: 300s
    http_server_write_timeout: 300s
    grpc_server_max_recv_msg_size: 8388608   # 8 MB
    grpc_server_max_send_msg_size: 8388608   # 8 MB

  querier:
    max_concurrent: 24

  storage:
    type: azure
    bucketNames:
      chunks: loki-prod-chunks
      ruler: loki-prod-ruler
      admin: loki-prod-admin
    azure:
      accountName: k8slokistorageforlogs
      accountKey: provide key
      useManagedIdentity: false
      useFederatedToken: false


  compactor:
    compaction_interval: 10m
    retention_enabled: true
    retention_delete_delay: 2h
    retention_delete_worker_count: 150
    delete_request_store: azure

  schemaConfig:
    configs:
      - from: "2024-04-10"
        store: tsdb
        object_store: azure
        schema: v13
        index:
          prefix: loki_index_
          period: 24h

  rulerConfig:
    alertmanager_url: http://kube-prometheus-stack-alertmanager.monitoring.svc:9093
    external_labels:
      origin: loki
      region: centralindia
      cluster: mashreq
    storage:
      type: local
      local:
        directory: /rules

  ingester:
    max_chunk_age: 2h
    chunk_encoding: zstd

  limits_config:
    ingestion_rate_mb: 9
    ingestion_burst_size_mb: 10
    per_stream_rate_limit: 5MB
    per_stream_rate_limit_burst: 20MB
    split_queries_by_interval: 15m
    retention_period: 60d
    max_line_size: 256KB
    max_line_size_truncate: true
    max_concurrent_tail_requests: 20
    retention_stream:
      - selector: '{namespace="document-validation",app="watchdog"}'
        priority: 10
        period: 7d
      - selector: '{namespace="kube-system"}'
        priority: 1
        period: 30d
      - selector: '{namespace="monitoring"}'
        priority: 1
        period: 30d
